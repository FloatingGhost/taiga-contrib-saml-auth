(function(){var AUTH_URL,SamlLoginButtonDirective,module;AUTH_URL="/saml/initiate-login/",SamlLoginButtonDirective=function($window,$params,$location,$config,$events,$confirm,$auth,$navUrls,$loader){var link;return link=function($scope,$el,$attrs){var loginOnError,loginOnSuccess,loginWithSamlAccount;return loginOnSuccess=function(response){var nextUrl;return nextUrl=$params.next&&$params.next!==$navUrls.resolve("login")?$params.next:$navUrls.resolve("home"),$events.setupConnection(),$location.search("next",null),$location.search("token",null),$location.search("state",null),$location.path(nextUrl)},loginOnError=function(response){return $location.search("state",null),$loader.pageLoaded(),response.data._error_message?$confirm.notify("light-error",response.data._error_message):$confirm.notify("light-error","Our Oompa Loompas have not been able to get your credentials with SAML.")},loginWithSamlAccount=function(){var data,token,type;if(type=$params.state,token=$params.token,"saml"===type)return $loader.start(!0),data={token:token},$auth.login(data,type).then(loginOnSuccess,loginOnError)},loginWithSamlAccount(),$el.on("click",".button-auth",function(event){var url;return url=$params.next?AUTH_URL+"?next="+$params.next:AUTH_URL,$window.location.href=url}),$scope.$on("$destroy",function(){return $el.off()})},{link:link,restrict:"EA",template:""}},module=angular.module("taigaContrib.samlAuth",[]),module.directive("tgSamlLoginButton",["$window","$routeParams","$tgLocation","$tgConfig","$tgEvents","$tgConfirm","$tgAuth","$tgNavUrls","tgLoader",SamlLoginButtonDirective])}).call(this),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("/plugins/saml-auth/saml-auth.html",'\n<div tg-saml-login-button="tg-saml-login-button"><a href="" title="Enter with your SAML account" class="button button-auth"><span>Sign in with SAML</span></a></div>')}]);